# 自定义域名配置指南

本指南将帮助您为峰叔靠谱博客配置自定义域名。

## 支持的部署平台

### Railway（推荐）

Railway是现代化的云平台，支持一键部署和自定义域名配置。

**配置步骤：**
1. 登录Railway控制台
2. 进入项目设置
3. 在Domains部分添加您的自定义域名
4. 按照平台指示配置DNS记录（CNAME或A记录）
5. 等待SSL证书自动配置完成

### 传统服务器部署

对于在传统服务器上的部署，您可以使用我们提供的新脚本来简化配置过程。

**可用脚本：**
- `npm run start:host` - 使用自定义主机地址启动（适用于局域网访问）
- `npm run start:domain` - 使用自定义主机地址和HTTPS启动

这些脚本已经预配置了适当的环境变量，使您能够更轻松地部署到自定义域名环境。

### Heroku

1. 在Heroku应用的Settings选项卡中，找到"Domains"部分
2. 点击"Add domain"并输入您的自定义域名
3. Heroku会提供一个DNS目标地址
4. 在您的域名提供商处添加相应的CNAME记录

### Vercel

1. 在Vercel项目中，进入Settings > Domains
2. 添加您的自定义域名
3. Vercel会提供验证和DNS配置说明
4. 按照指示在您的域名提供商处配置DNS记录

### 传统服务器

如果您在自己的服务器上部署博客，需要配置Web服务器（如Nginx或Apache）来处理域名解析。

## 环境变量配置

在使用自定义域名时，您可能需要配置以下环境变量：

- `HOST` - 服务器绑定的主机地址（默认为localhost）
- `PORT` - HTTP服务器端口（默认为3000）
- `HTTPS_PORT` - HTTPS服务器端口（默认为8443）

## SSL证书配置

如果您使用自定义域名并启用了HTTPS：

1. 获取权威机构签发的SSL证书
2. 将证书文件放置在`certs`目录中，替换现有的自签名证书
3. 确保`.env.production`文件中配置了正确的环境变量

## DNS配置示例

### CNAME记录（推荐）

```
类型: CNAME
名称: blog (或您的子域名)
值: 您的平台提供的域名 (例如：your-app.railway.app)
TTL: 300
```

### A记录（直接IP指向）

```
类型: A
名称: @ (或您的子域名)
值: 您服务器的IP地址
TTL: 300
```

## 配置步骤

### 1. 准备工作

1. 注册并拥有一个域名
2. 确定您要使用的子域名（如blog.yourdomain.com）
3. 选择部署平台

### 2. 平台配置

1. 在您的部署平台添加自定义域名
2. 获取平台提供的DNS配置信息

### 3. DNS配置

1. 登录您的域名提供商管理面板
2. 根据平台提供的信息添加DNS记录
3. 等待DNS传播（通常需要几分钟到几小时）

### 4. 应用配置

1. 更新环境变量配置文件（.env.production）
2. 如果需要，配置SSL证书
3. 重启应用使配置生效

## 验证配置

配置完成后，您可以通过以下方式验证：

1. 访问您的自定义域名
2. 检查SSL证书是否有效（如果启用了HTTPS）
3. 确认所有页面正常加载

## 故障排除

### 常见问题

1. **域名无法访问**
   - 检查DNS记录是否正确
   - 确认DNS已传播完成
   - 检查防火墙设置

2. **SSL证书错误**
   - 确认证书文件放置在正确位置
   - 检查证书是否过期
   - 确认环境变量配置正确

3. **重定向问题**
   - 检查应用中的重定向配置
   - 确认环境变量中的域名设置

### 调试步骤

1. 使用`nslookup yourdomain.com`检查DNS解析
2. 使用`ping yourdomain.com`检查网络连通性
3. 检查应用日志中的错误信息

## 安全建议

1. 始终使用HTTPS保护用户数据
2. 定期更新SSL证书
3. 使用强密码保护管理后台
4. 定期备份网站数据和配置